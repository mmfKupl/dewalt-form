<div
  class="question"
  [formGroup]="form"
  *ngIf="
    !question.hiddenIfNotRequired ||
    (question.hiddenIfNotRequired && form.get(question.key).validator)
  "
  [ngSwitch]="question.controlType"
>
  <label
    *ngIf="question.controlType !== 'checkbox'"
    class="question__label"
    [attr.for]="question.key"
    >{{ question.label }}</label
  >

  <input
    *ngSwitchCase="'textbox'"
    class="question__answer question__input
  input"
    [formControlName]="question.key"
    [id]="question.key"
    [type]="question.type"
    [required]="question.required"
    [name]="question.name || question.key"
    [maxlength]="question.fixedLength || null"
  />

  <div *ngSwitchCase="'date'" class="question__datebox">
    <input
      [formControlName]="question.key"
      [required]="question.required"
      [id]="question.key"
      class="question__answer question__input input"
      matInput
      [matDatepicker]="picker"
      [name]="question.name || question.key"
    />
    <mat-datepicker #picker></mat-datepicker>
    <button
      class="button question__button"
      mat-raised-button
      (click)="picker.open()"
    >
      Выбарть
    </button>
  </div>

  <div
    *ngSwitchCase="'textbox-array'"
    [formArrayName]="question.key"
    class="question__textbox-array"
  >
    <input
      class="question__answer question__input input"
      *ngFor="let inp of getFormArray(question.key).controls; let i = index"
      [type]="question.type"
      [id]="i"
      [formControlName]="i"
    />
    <button
      (click)="onFormArrayButtonClick()"
      class="textbox-array__add-button"
    >
      Добавить
    </button>
  </div>

  <mat-checkbox
    *ngSwitchCase="'checkbox'"
    class="question__answer question__input question__input-checkbox"
    [formControlName]="question.key"
    [id]="question.key"
    type="checkbox"
    [required]="question.required"
    [labelPosition]="'before'"
  >
    {{ question.label }}</mat-checkbox
  >

  <mat-radio-group
    *ngSwitchCase="'radio'"
    class="question__answer question__input-radio-group"
    [formControlName]="question.key"
    [id]="question.key"
  >
    <mat-radio-button
      class="question__answer question__input question__input-checkbox question__input-radio"
      *ngFor="let btn of question.values"
      [id]="btn.key"
      [value]="btn.key"
      >{{ btn.label }}</mat-radio-button
    >
  </mat-radio-group>

  <mat-select
    *ngSwitchCase="'dropdown'"
    class="question__answer question__select select"
    [id]="question.key"
    [formControlName]="question.key"
    [required]="question.required"
  >
    <mat-option *ngFor="let opt of question.options" [value]="opt.key">{{
      opt.value
    }}</mat-option>
  </mat-select>

  <textarea
    *ngSwitchCase="'textarea'"
    class="question__answer question__textarea textarea"
    [formControlName]="question.key"
    [id]="question.key"
    [required]="question.required"
    [name]="question.name || question.key"
  ></textarea>
</div>
